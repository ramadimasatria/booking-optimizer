(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,function(t,e,n){t.exports=n.p+"static/media/right-arrow.279196e3.svg"},,,function(t){t.exports=[{id:1,start:3,end:1},{id:2,start:1,end:3},{id:3,start:3,end:1},{id:4,start:2,end:2},{id:5,start:3,end:1},{id:6,start:2,end:3},{id:7,start:1,end:3},{id:8,start:1,end:1},{id:9,start:3,end:3},{id:10,start:3,end:2},{id:11,start:3,end:3},{id:12,start:3,end:2},{id:13,start:1,end:1},{id:14,start:1,end:3},{id:15,start:3,end:2},{id:16,start:3,end:2},{id:17,start:1,end:3},{id:18,start:3,end:3}]},,,,,function(t,e,n){t.exports=n(24)},,,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var a=n(0),i=n.n(a),r=n(12),s=n.n(r),o=n(3),c=n(4),l=n(7),d=n(5),m=n(1),u=n(8),h=n(13),p=(n(20),n(6)),g=n.n(p),f=function(t){var e=t.booking;return i.a.createElement("div",{className:"booking-item"},i.a.createElement("span",{className:"booking-item__id"},e.id),i.a.createElement("span",{className:"booking-item__start"},e.start),i.a.createElement("span",{className:"booking-item__arrow"},i.a.createElement("img",{src:g.a,alt:"arrow"})),i.a.createElement("span",{className:"booking-item__end"},e.end))},v=(n(21),function(t){return i.a.createElement("span",{className:"separator ".concat(t.relocate&&"separator--relocate")},i.a.createElement("img",{src:g.a,alt:"arrow"}))}),E=(n(22),function(t){var e=t.order;return i.a.createElement("div",{className:"booking-order"},e.map(function(t,e,n){var a=n[e+1],r=a&&a.start!==t.end;return i.a.createElement(i.a.Fragment,{key:t.id},i.a.createElement(f,{booking:t}),a&&i.a.createElement(v,{relocate:r}))}))}),b=n(10),k=function(){function t(){Object(o.a)(this,t),this.original=[],this.optimized=[],this.originalRelocations=0,this.optimizedRelocations=0,this.bookingsById={},this.connected={},this.starts={},this.ends={}}return Object(c.a)(t,[{key:"optimize",value:function(t){var e=this;this.original=t,this.originalRelocations=0,this.original.forEach(function(t,n){if(!t.id||!t.start||!t.end)throw new Error("Invalid data");e.bookingsById[t.id]=t,e.connected[t.id]=[t.id];var a=e.original[n+1];a&&a.start!==t.end&&e.originalRelocations++}),this.groupStartsEnds();for(var n=this.getMostPair();n;)this.connectByPairKey(n),this.groupStartsEnds(),n=this.getMostPair();this.optimized=Object.values(this.connected).flat().map(function(t){return e.getBookingById(t)}),this.optimizedRelocations=Object.keys(this.connected).length-1}},{key:"getBookingById",value:function(t){return this.bookingsById[t]}},{key:"getConnectedData",value:function(t){var e=this.connected[t];return{id:t,start:this.getBookingById(e[0]).start,end:this.getBookingById(e[e.length-1]).end}}},{key:"getMostPair",value:function(){var t=this,e=0,n=0;return Object.keys(this.starts).forEach(function(a){if(t.ends[a]){var i=Math.min(t.starts[a].length,t.ends[a].length);i>n&&(n=i,e=parseInt(a,10))}}),n>0?e:null}},{key:"groupStartsEnds",value:function(){var t=this,e={},n={};Object.keys(this.connected).forEach(function(a){var i=t.getConnectedData(a),r=i.start,s=i.end;e[r]||(e[r]=[]),n[s]||(n[s]=[]),e[r].push(a),n[s].push(a)}),this.starts=e,this.ends=n}},{key:"connectBookings",value:function(t){var e=this,n=t[0];this.connected[n]=[].concat(Object(b.a)(this.connected[n]),Object(b.a)(t.slice(1).map(function(t){return e.connected[t]}).flat())),t.slice(1).forEach(function(t){delete e.connected[t]})}},{key:"connectByPairKey",value:function(t){var e=this,n=this.starts[t],a=this.ends[t],i=n.filter(function(t){var n=e.getConnectedData(t);return n.start===n.end});i.length&&(this.connectBookings(i),n=n.filter(function(t){return!i.includes(t)}),a=a.filter(function(t){return!i.includes(t)}),(n.length<a.length?n:a).push(i[0]));for(;n.length&&a.length;){var r=n.shift(),s=a.shift();if(!r||!s)break;this.connectBookings([s,r])}}}]),t}(),y=n(9),_=(n(23),new k),O=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).refJsonField=void 0,n.state={},n.refJsonField=i.a.createRef(),n.optimize=n.optimize.bind(Object(m.a)(n)),n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"optimize",value:function(){var t=this.refJsonField.current.state,e=t.jsObject?t.jsObject:y;try{_.optimize(e)}catch(n){return void alert("Invalid data")}this.setState({original:_.original,optimized:_.optimized,originalRelocations:_.originalRelocations,optimizedRelocations:_.optimizedRelocations})}},{key:"render",value:function(){var t=this.state;return i.a.createElement("div",{className:"app"},i.a.createElement("h1",{className:"app__title"},"Booking Order Optimizer"),i.a.createElement("div",{className:"app_section"},i.a.createElement("h3",{className:"app__subtitle"},"Input Data"),i.a.createElement(h.a,{id:"editor",placeholder:y,height:"400px",theme:"light_mitsuketa_tribute",width:"100%",ref:this.refJsonField}),i.a.createElement("p",{style:{textAlign:"center"}},i.a.createElement("button",{className:"button",style:{marginTop:18},onClick:this.optimize},"Optimize!"))),i.a.createElement("hr",{className:"app_separator"}),t.original&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"app__section"},i.a.createElement("h3",{className:"app__subtitle"},"Original Order"),i.a.createElement(E,{order:t.original}),i.a.createElement("p",null,"Relocations: ",t.originalRelocations)),i.a.createElement("hr",{className:"app__separator"})),t.optimized&&i.a.createElement("div",{className:"app__section"},i.a.createElement("h3",{className:"app__subtitle"},"Optimized Order"),i.a.createElement(E,{order:t.optimized}),i.a.createElement("p",null,"Relocations: ",t.optimizedRelocations)))}}]),e}(i.a.Component);s.a.render(i.a.createElement(O,null),document.getElementById("root"))}],[[14,1,2]]]);
//# sourceMappingURL=main.bd7adf1f.chunk.js.map